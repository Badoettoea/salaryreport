<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>User Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700 displayswap" rel="stylesheet">
  <style>
    body.light-mode {
      background-color: #fef5f5;
      color: #1e4f5e;
    }
    body.light-mode .bg-teal-500 { background-color: #2dd4bf; }
    body.light-mode .text-white { color: #ffffff; }
    body.light-mode .bg-teal-50 { background-color: #e6fffa; }
    body.light-mode .text-teal-800 { color: #1e4f5e; }
    body.light-mode .text-teal-600 { color: #1e4f5e; }
    body.light-mode .input-field {
      background-color: #ffffff;
      color: #1e4f5e;
      border-color: #2dd4bf;
    }
    body.light-mode .btn-primary { background-color: #2dd4bf; }
    body.light-mode .btn-danger { background-color: #f87171; }

    body.dark-mode {
      background-color: #1e293b;
      color: #e2e8f0;
    }
    body.dark-mode .bg-teal-500 { background-color: #0f766e; }
    body.dark-mode .text-white { color: #e2e8f0; }
    body.dark-mode .bg-teal-50 { background-color: #2d4a48; }
    body.dark-mode .text-teal-800 { color: #a5f3fc; }
    body.dark-mode .text-teal-600 { color: #a5f3fc; }
    body.dark-mode .input-field {
      background-color: #334155;
      color: #e2e8f0;
      border-color: #0f766e;
    }
    body.dark-mode .btn-primary { background-color: #0f766e; }
    body.dark-mode .btn-danger { background-color: #b91c1c; }

    .profile-pic {
      width: 180px; /* Diperbesar 80% dari 100px */
      height: 180px;
      border-radius: 0; /* Kotak */
      object-fit: cover;
    }
  </style>
</head>
<body class="min-h-screen p-4 font-poppins transition-colors duration-300">
  <div class="max-w-4xl mx-auto">
    <div class="flex justify-between items-center mb-6 bg-teal-500 p-4 rounded-xl shadow-lg">
      <h1 class="text-2xl font-bold text-white">
        <i class="fas fa-tachometer-alt mr-2"></i>User Dashboard
      </h1>
      <button onclick="logout()" class="btn-danger ripple">
        <i class="fas fa-sign-out-alt mr-2"></i>Logout
      </button>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div class="card flex flex-col items-center">
        <img src="https://via.placeholder.com/180" alt="Profile Picture" class="profile-pic mb-4">
        <h2 id="userName" class="text-xl font-semibold text-teal-600"></h2>
        <p id="userUnit" class="text-teal-800"></p>
      </div>

      <div class="card">
        <h2 class="text-xl font-semibold mb-3 text-teal-600">
          <i class="fas fa-money-bill-wave mr-2"></i>Detail Gaji
        </h2>
        <div class="bg-teal-50 p-4 rounded-lg">
          <p class="text-teal-800 mb-2"><strong>Gaji Kotor:</strong> <span id="gajiKotor"></span></p>
          <div id="potonganList"></div>
          <p class="text-teal-800 mt-2 font-semibold"><strong>Total Potongan:</strong> <span id="totalPotongan"></span></p>
          <p class="text-teal-800 mt-2 font-bold"><strong>Gaji Bersih:</strong> <span id="gajiBersih"></span></p>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Apply saved theme on page load
    document.addEventListener('DOMContentLoaded', () => {
      const savedTheme = localStorage.getItem('theme') || 'light';
      document.body.classList.add(savedTheme + '-mode');

      const currentUser = JSON.parse(localStorage.getItem('currentUser'));
      if (!currentUser || currentUser.Role !== 'User') {
        alert('Akses ditolak. Hanya User yang dapat mengakses dashboard ini.');
        window.location.href = 'index.html';
        return;
      }

      document.getElementById('userName').textContent = currentUser.Nama || 'Nama Tidak Diketahui';
      document.getElementById('userUnit').textContent = currentUser['Unit Kerja'] || 'Unit Kerja Tidak Diketahui';

      const gajiKotor = parseFloat(currentUser['Gaji Kotor']) || 0;
      document.getElementById('gajiKotor').textContent = gajiKotor.toLocaleString('id-ID', { style: 'currency', currency: 'IDR' });

      const potonganKeys = Object.keys(currentUser).filter(key => key.includes('Potongan') || key === 'DPLK' || key === 'KPRI' || key === 'PGRI' || key === 'HPPT' || key === 'Dansos' || key === 'Bazda' || key === 'Darma Wanita' || key === 'Korpri' || key === 'Halbi');
      const potonganList = document.getElementById('potonganList');
      let totalPotongan = 0;

      potonganKeys.forEach(key => {
        const potonganValue = parseFloat(currentUser[key]) || 0;
        if (potonganValue > 0) {
          totalPotongan += potonganValue;
          const p = document.createElement('p');
          p.className = 'text-teal-800 mb-1';
          p.innerHTML = `<strong>${key}:</strong> ${potonganValue.toLocaleString('id-ID', { style: 'currency', currency: 'IDR' })}`;
          potonganList.appendChild(p);
        }
      });

      document.getElementById('totalPotongan').textContent = totalPotongan.toLocaleString('id-ID', { style: 'currency', currency: 'IDR' });
      const gajiBersih = gajiKotor - totalPotongan;
      document.getElementById('gajiBersih').textContent = gajiBersih.toLocaleString('id-ID', { style: 'currency', currency: 'IDR' });

      // Ripple effect for buttons
      document.querySelectorAll('.ripple').forEach(button => {
        button.addEventListener('click', function(e) {
          const ripple = document.createElement('span');
          ripple.classList.add('ripple-effect');
          const rect = button.getBoundingClientRect();
          const size = Math.max(rect.width, rect.height);
          ripple.style.width = ripple.style.height = `${size}px`;
          ripple.style.left = `${e.clientX - rect.left - size / 2}px`;
          ripple.style.top = `${e.clientY - rect.top - size / 2}px`;
          button.appendChild(ripple);
          setTimeout(() => ripple.remove(), 600);
        });
      });
    });

    function logout() {
      localStorage.removeItem('currentUser');
      window.location.href = 'index.html';
    }
  </script>
</body>
</html>
